<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>체스판 + 기물 + 클릭 이동</title>
  <style>
    #board {
      display: grid;
      grid-template-columns: repeat(8, 70px);
      grid-template-rows: repeat(8, 70px);
      width: 560px;
      height: 560px;
      border: 3px solid #333;
      margin: 30px auto;
      box-shadow: 0 0 15px rgba(0,0,0,0.3);
      user-select: none;
    }
    .square {
      width: 70px;
      height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 44px;
      cursor: pointer;
      transition: background-color 0.3s;
      border: 1px solid #555;
      box-sizing: border-box;
    }
    .white {
      background-color: #f0d9b5;
    }
    .black {
      background-color: #b58863;
    }
    .square:hover {
      filter: brightness(1.15);
    }
    .selected {
      outline: 3px solid #ff5722;
      outline-offset: -3px;
    }
    .highlight {
      background-color: #aaffaa !important;
    }
  </style>
</head>
<body>
  <h1 style="text-align:center; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;">
    체스판 + 기물 + 클릭 이동 기능
  </h1>

  <div id="board"></div>

  <script>
    const PIECES = {
      'r': '♜', 'n': '♞', 'b': '♝', 'q': '♛', 'k': '♚', 'p': '♟',
      'R': '♖', 'N': '♘', 'B': '♗', 'Q': '♕', 'K': '♔', 'P': '♙'
    };

    // 초기 기본 체스판 상태
    let boardState = [
      ['r','n','b','q','k','b','n','r'],
      ['p','p','p','p','p','p','p','p'],
      ['','','','','','','',''],
      ['','','','','','','',''],
      ['','','','','','','',''],
      ['','','','','','','',''],
      ['P','P','P','P','P','P','P','P'],
      ['R','N','B','Q','K','B','N','R']
    ];

    const boardEl = document.getElementById("board");

    let selected = null; // 선택된 칸 좌표 [row, col]

    function renderBoard() {
      boardEl.innerHTML = "";

      for(let row=0; row<8; row++) {
        for(let col=0; col<8; col++) {
          const square = document.createElement("div");
          square.classList.add("square");
          if ((row + col) % 2 === 0) square.classList.add("white");
          else square.classList.add("black");

          // 좌표 저장
          square.dataset.row = row;
          square.dataset.col = col;

          // 기물 표시
          const piece = boardState[row][col];
          if(piece) square.textContent = PIECES[piece];

          // 선택된 칸 표시
          if(selected && selected[0] === row && selected[1] === col) {
            square.classList.add("selected");
          }

          // 클릭 이벤트
          square.addEventListener("click", () => {
            onSquareClick(row, col);
          });

          boardEl.appendChild(square);
        }
      }
    }

    // 클릭했을 때 처리
    function onSquareClick(row, col) {
      const piece = boardState[row][col];

      if(selected === null) {
        // 기물이 있는 칸만 선택 가능
        if(piece) {
          selected = [row, col];
          renderBoard();
        }
      } else {
        // 선택된 칸이 있을 때
        if(row === selected[0] && col === selected[1]) {
          // 같은 칸 다시 클릭하면 선택 해제
          selected = null;
          renderBoard();
          return;
        }

        // 선택된 칸에서 움직이기: 아주 간단한 룰 없이 그냥 빈칸 혹은 상대기물이면 이동 허용
        const selectedPiece = boardState[selected[0]][selected[1]];
        const targetPiece = boardState[row][col];

        if(!targetPiece || isOpponent(selectedPiece, targetPiece)) {
          // 이동 수행
          boardState[row][col] = selectedPiece;
          boardState[selected[0]][selected[1]] = '';
          selected = null;
          renderBoard();
        } else {
          // 아군 기물이면 선택 칸 변경
          if(piece) {
            selected = [row, col];
            renderBoard();
          }
        }
      }
    }

    // 상대편 기물인지 확인 (대문자-백, 소문자-흑 기준)
    function isOpponent(piece1, piece2) {
      if(!piece1 || !piece2) return false;
      return (isUpper(piece1) && isLower(piece2)) || (isLower(piece1) && isUpper(piece2));
    }
    function isUpper(c) { return c === c.toUpperCase(); }
    function isLower(c) { return c === c.toLowerCase(); }

    renderBoard();
  </script>
</body>
</html>
